name: DeskHub CI/CD

# ---- DISPARADOR ----
on:
  push:
    branches:
      - main
      - develop
      - master
  pull_request:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # 1. Descargar el código
      - name: Checkout del repositorio
        uses: actions/checkout@v3

      # 2. Configurar Python (ajusta versión si lo necesitas)
      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"

      # 3. Instalar dependencias
      - name: Instalar dependencias
        run: |
          python -m pip install --upgrade pip
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi

      # 4. Ejecutar pruebas (si existe carpeta tests)
      - name: Ejecutar pruebas
        run: |
          if [ -d tests ]; then pytest -q; else echo "No hay pruebas para ejecutar"; fi

      # 5. Build opcional
      - name: Build del proyecto
        run: echo "Construyendo proyecto DeskHub..."

      # 6. Despliegue (solo en main)
      - name: Deploy
        if: github.ref == 'refs/heads/main'
        run: echo "Desplegando a producción..."

 
